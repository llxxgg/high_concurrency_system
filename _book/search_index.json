{"index":{"version":"0.5.12","fields":[{"name":"title","boost":10},{"name":"keywords","boost":15},{"name":"body","boost":1}],"ref":"url","documentStore":{"store":{"./":["introduct"],"read_more_write_less/":["读多写少系统"],"read_more_write_less/raft.html":["candidate：选举模式，集群中没有leader节点。","follow","leader宕机后，follower如果在超时时间内没有收到leader的心跳，会发起新一轮的leader投票选举。如果全部follower都在同一时间发起leader投票选举，会造成选举混乱，raft利用随机超时巧妙避开了这些问题。","leader强制覆盖之后不一致的日志。","leader找到follower与自己相同的最大日志项，意味着follower之前的日志都与leader的日志相同。","leader是如何识别出follower的日志与自己的日志有差异呢？","leader给follower同步日志的时候，会同时带上leader上一条日志的任期和索引号，与follower当前的同步进度进行对比。","leader选举","leader：负责接收写请求，同步日志给follower，维护与follower的心跳，刷新follower的超时时间","raft","raft复制过程：leader接收到客户端发来的请求，创建一个新的日志项，并将其追加到本地日志中，接着leader通过追加条目rpc请求，将新的日志项复制到follower的本地日志中，当leader收到大多数follower的成功响应之后，则将这条日志项应用到状态机中，可以理解为该条日志写成功了，最后leader返回日志写成功的消息响应客户端。","raft的日志以日志项（logentry）的形式来组织，每个日志项包含一条命令、任期信息（term）、索引值（logindex）","共识算法","因此，raft日志追加大致分为两个步骤：","在raft的日志机制中，为了简化日志一致性的行为，有以下两点特性：","如何保证日志的一致性？","如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们之前的所有日志条目也全部相同。","如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们存储了相同的指令。","所有服务都没有获取到多数票，就会等当前选举超时后，对term加1，再次进行选举。最终，获取多数票且最先结束选举倒计时的服务会被选为leader。","收到投票申请的节点，并且发送投票的节点的任期和同步进度（即logindex和term）都比当前节点超前或者相同，那么就会投发送投票的节点一票，并把当前的term更新为最新的term。同时，这个收到投票申请的节点不会再发起投票。每个节点在同一任期内只会投票一次。","日志复制","节点状态：","被选为leader的节点会发送广播通知其他节点，并向其他节点同步新的term和同步进度情况。同时，新leader会在任期期间周期性发送心跳，不断刷新follower的超时时间，保证各个follower不会因为超时而切换到选举模式。如果节点收到上一任期的心跳，会拒绝。","选举结束后，所有节点进入数据同步状态。"]},"length":3},"tokenStore":{"root":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"r":{"docs":{},"o":{"docs":{},"d":{"docs":{},"u":{"docs":{},"c":{"docs":{},"t":{"docs":{"./":{"ref":"./","tf":11}}}}}}}}}}},"读":{"docs":{},"多":{"docs":{},"写":{"docs":{},"少":{"docs":{},"系":{"docs":{},"统":{"docs":{"read_more_write_less/":{"ref":"read_more_write_less/","tf":11}}}}}}}},"c":{"docs":{},"a":{"docs":{},"n":{"docs":{},"d":{"docs":{},"i":{"docs":{},"d":{"docs":{},"a":{"docs":{},"t":{"docs":{},"e":{"docs":{},"：":{"docs":{},"选":{"docs":{},"举":{"docs":{},"模":{"docs":{},"式":{"docs":{},"，":{"docs":{},"集":{"docs":{},"群":{"docs":{},"中":{"docs":{},"没":{"docs":{},"有":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"节":{"docs":{},"点":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"宕":{"docs":{},"机":{"docs":{},"后":{"docs":{},"，":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"如":{"docs":{},"果":{"docs":{},"在":{"docs":{},"超":{"docs":{},"时":{"docs":{},"时":{"docs":{},"间":{"docs":{},"内":{"docs":{},"没":{"docs":{},"有":{"docs":{},"收":{"docs":{},"到":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"心":{"docs":{},"跳":{"docs":{},"，":{"docs":{},"会":{"docs":{},"发":{"docs":{},"起":{"docs":{},"新":{"docs":{},"一":{"docs":{},"轮":{"docs":{},"的":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"投":{"docs":{},"票":{"docs":{},"选":{"docs":{},"举":{"docs":{},"。":{"docs":{},"如":{"docs":{},"果":{"docs":{},"全":{"docs":{},"部":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"都":{"docs":{},"在":{"docs":{},"同":{"docs":{},"一":{"docs":{},"时":{"docs":{},"间":{"docs":{},"发":{"docs":{},"起":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"投":{"docs":{},"票":{"docs":{},"选":{"docs":{},"举":{"docs":{},"，":{"docs":{},"会":{"docs":{},"造":{"docs":{},"成":{"docs":{},"选":{"docs":{},"举":{"docs":{},"混":{"docs":{},"乱":{"docs":{},"，":{"docs":{},"r":{"docs":{},"a":{"docs":{},"f":{"docs":{},"t":{"docs":{},"利":{"docs":{},"用":{"docs":{},"随":{"docs":{},"机":{"docs":{},"超":{"docs":{},"时":{"docs":{},"巧":{"docs":{},"妙":{"docs":{},"避":{"docs":{},"开":{"docs":{},"了":{"docs":{},"这":{"docs":{},"些":{"docs":{},"问":{"docs":{},"题":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"强":{"docs":{},"制":{"docs":{},"覆":{"docs":{},"盖":{"docs":{},"之":{"docs":{},"后":{"docs":{},"不":{"docs":{},"一":{"docs":{},"致":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}},"找":{"docs":{},"到":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"与":{"docs":{},"自":{"docs":{},"己":{"docs":{},"相":{"docs":{},"同":{"docs":{},"的":{"docs":{},"最":{"docs":{},"大":{"docs":{},"日":{"docs":{},"志":{"docs":{},"项":{"docs":{},"，":{"docs":{},"意":{"docs":{},"味":{"docs":{},"着":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"之":{"docs":{},"前":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"都":{"docs":{},"与":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"相":{"docs":{},"同":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"是":{"docs":{},"如":{"docs":{},"何":{"docs":{},"识":{"docs":{},"别":{"docs":{},"出":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"与":{"docs":{},"自":{"docs":{},"己":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"有":{"docs":{},"差":{"docs":{},"异":{"docs":{},"呢":{"docs":{},"？":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"给":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"同":{"docs":{},"步":{"docs":{},"日":{"docs":{},"志":{"docs":{},"的":{"docs":{},"时":{"docs":{},"候":{"docs":{},"，":{"docs":{},"会":{"docs":{},"同":{"docs":{},"时":{"docs":{},"带":{"docs":{},"上":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"上":{"docs":{},"一":{"docs":{},"条":{"docs":{},"日":{"docs":{},"志":{"docs":{},"的":{"docs":{},"任":{"docs":{},"期":{"docs":{},"和":{"docs":{},"索":{"docs":{},"引":{"docs":{},"号":{"docs":{},"，":{"docs":{},"与":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"当":{"docs":{},"前":{"docs":{},"的":{"docs":{},"同":{"docs":{},"步":{"docs":{},"进":{"docs":{},"度":{"docs":{},"进":{"docs":{},"行":{"docs":{},"对":{"docs":{},"比":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"选":{"docs":{},"举":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}},"：":{"docs":{},"负":{"docs":{},"责":{"docs":{},"接":{"docs":{},"收":{"docs":{},"写":{"docs":{},"请":{"docs":{},"求":{"docs":{},"，":{"docs":{},"同":{"docs":{},"步":{"docs":{},"日":{"docs":{},"志":{"docs":{},"给":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"，":{"docs":{},"维":{"docs":{},"护":{"docs":{},"与":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"心":{"docs":{},"跳":{"docs":{},"，":{"docs":{},"刷":{"docs":{},"新":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"超":{"docs":{},"时":{"docs":{},"时":{"docs":{},"间":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"r":{"docs":{},"a":{"docs":{},"f":{"docs":{},"t":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":10.041666666666666}},"复":{"docs":{},"制":{"docs":{},"过":{"docs":{},"程":{"docs":{},"：":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"接":{"docs":{},"收":{"docs":{},"到":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"发":{"docs":{},"来":{"docs":{},"的":{"docs":{},"请":{"docs":{},"求":{"docs":{},"，":{"docs":{},"创":{"docs":{},"建":{"docs":{},"一":{"docs":{},"个":{"docs":{},"新":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"项":{"docs":{},"，":{"docs":{},"并":{"docs":{},"将":{"docs":{},"其":{"docs":{},"追":{"docs":{},"加":{"docs":{},"到":{"docs":{},"本":{"docs":{},"地":{"docs":{},"日":{"docs":{},"志":{"docs":{},"中":{"docs":{},"，":{"docs":{},"接":{"docs":{},"着":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"通":{"docs":{},"过":{"docs":{},"追":{"docs":{},"加":{"docs":{},"条":{"docs":{},"目":{"docs":{},"r":{"docs":{},"p":{"docs":{},"c":{"docs":{},"请":{"docs":{},"求":{"docs":{},"，":{"docs":{},"将":{"docs":{},"新":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"项":{"docs":{},"复":{"docs":{},"制":{"docs":{},"到":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"本":{"docs":{},"地":{"docs":{},"日":{"docs":{},"志":{"docs":{},"中":{"docs":{},"，":{"docs":{},"当":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"收":{"docs":{},"到":{"docs":{},"大":{"docs":{},"多":{"docs":{},"数":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"成":{"docs":{},"功":{"docs":{},"响":{"docs":{},"应":{"docs":{},"之":{"docs":{},"后":{"docs":{},"，":{"docs":{},"则":{"docs":{},"将":{"docs":{},"这":{"docs":{},"条":{"docs":{},"日":{"docs":{},"志":{"docs":{},"项":{"docs":{},"应":{"docs":{},"用":{"docs":{},"到":{"docs":{},"状":{"docs":{},"态":{"docs":{},"机":{"docs":{},"中":{"docs":{},"，":{"docs":{},"可":{"docs":{},"以":{"docs":{},"理":{"docs":{},"解":{"docs":{},"为":{"docs":{},"该":{"docs":{},"条":{"docs":{},"日":{"docs":{},"志":{"docs":{},"写":{"docs":{},"成":{"docs":{},"功":{"docs":{},"了":{"docs":{},"，":{"docs":{},"最":{"docs":{},"后":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"返":{"docs":{},"回":{"docs":{},"日":{"docs":{},"志":{"docs":{},"写":{"docs":{},"成":{"docs":{},"功":{"docs":{},"的":{"docs":{},"消":{"docs":{},"息":{"docs":{},"响":{"docs":{},"应":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"以":{"docs":{},"日":{"docs":{},"志":{"docs":{},"项":{"docs":{},"（":{"docs":{},"l":{"docs":{},"o":{"docs":{},"g":{"docs":{},"e":{"docs":{},"n":{"docs":{},"t":{"docs":{},"r":{"docs":{},"y":{"docs":{},"）":{"docs":{},"的":{"docs":{},"形":{"docs":{},"式":{"docs":{},"来":{"docs":{},"组":{"docs":{},"织":{"docs":{},"，":{"docs":{},"每":{"docs":{},"个":{"docs":{},"日":{"docs":{},"志":{"docs":{},"项":{"docs":{},"包":{"docs":{},"含":{"docs":{},"一":{"docs":{},"条":{"docs":{},"命":{"docs":{},"令":{"docs":{},"、":{"docs":{},"任":{"docs":{},"期":{"docs":{},"信":{"docs":{},"息":{"docs":{},"（":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"m":{"docs":{},"）":{"docs":{},"、":{"docs":{},"索":{"docs":{},"引":{"docs":{},"值":{"docs":{},"（":{"docs":{},"l":{"docs":{},"o":{"docs":{},"g":{"docs":{},"i":{"docs":{},"n":{"docs":{},"d":{"docs":{},"e":{"docs":{},"x":{"docs":{},"）":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"共":{"docs":{},"识":{"docs":{},"算":{"docs":{},"法":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}},"因":{"docs":{},"此":{"docs":{},"，":{"docs":{},"r":{"docs":{},"a":{"docs":{},"f":{"docs":{},"t":{"docs":{},"日":{"docs":{},"志":{"docs":{},"追":{"docs":{},"加":{"docs":{},"大":{"docs":{},"致":{"docs":{},"分":{"docs":{},"为":{"docs":{},"两":{"docs":{},"个":{"docs":{},"步":{"docs":{},"骤":{"docs":{},"：":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}},"在":{"docs":{},"r":{"docs":{},"a":{"docs":{},"f":{"docs":{},"t":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"机":{"docs":{},"制":{"docs":{},"中":{"docs":{},"，":{"docs":{},"为":{"docs":{},"了":{"docs":{},"简":{"docs":{},"化":{"docs":{},"日":{"docs":{},"志":{"docs":{},"一":{"docs":{},"致":{"docs":{},"性":{"docs":{},"的":{"docs":{},"行":{"docs":{},"为":{"docs":{},"，":{"docs":{},"有":{"docs":{},"以":{"docs":{},"下":{"docs":{},"两":{"docs":{},"点":{"docs":{},"特":{"docs":{},"性":{"docs":{},"：":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"如":{"docs":{},"何":{"docs":{},"保":{"docs":{},"证":{"docs":{},"日":{"docs":{},"志":{"docs":{},"的":{"docs":{},"一":{"docs":{},"致":{"docs":{},"性":{"docs":{},"？":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}},"果":{"docs":{},"在":{"docs":{},"不":{"docs":{},"同":{"docs":{},"的":{"docs":{},"日":{"docs":{},"志":{"docs":{},"中":{"docs":{},"的":{"docs":{},"两":{"docs":{},"个":{"docs":{},"条":{"docs":{},"目":{"docs":{},"拥":{"docs":{},"有":{"docs":{},"相":{"docs":{},"同":{"docs":{},"的":{"docs":{},"索":{"docs":{},"引":{"docs":{},"和":{"docs":{},"任":{"docs":{},"期":{"docs":{},"号":{"docs":{},"，":{"docs":{},"那":{"docs":{},"么":{"docs":{},"他":{"docs":{},"们":{"docs":{},"之":{"docs":{},"前":{"docs":{},"的":{"docs":{},"所":{"docs":{},"有":{"docs":{},"日":{"docs":{},"志":{"docs":{},"条":{"docs":{},"目":{"docs":{},"也":{"docs":{},"全":{"docs":{},"部":{"docs":{},"相":{"docs":{},"同":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}},"存":{"docs":{},"储":{"docs":{},"了":{"docs":{},"相":{"docs":{},"同":{"docs":{},"的":{"docs":{},"指":{"docs":{},"令":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"所":{"docs":{},"有":{"docs":{},"服":{"docs":{},"务":{"docs":{},"都":{"docs":{},"没":{"docs":{},"有":{"docs":{},"获":{"docs":{},"取":{"docs":{},"到":{"docs":{},"多":{"docs":{},"数":{"docs":{},"票":{"docs":{},"，":{"docs":{},"就":{"docs":{},"会":{"docs":{},"等":{"docs":{},"当":{"docs":{},"前":{"docs":{},"选":{"docs":{},"举":{"docs":{},"超":{"docs":{},"时":{"docs":{},"后":{"docs":{},"，":{"docs":{},"对":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"m":{"docs":{},"加":{"1":{"docs":{},"，":{"docs":{},"再":{"docs":{},"次":{"docs":{},"进":{"docs":{},"行":{"docs":{},"选":{"docs":{},"举":{"docs":{},"。":{"docs":{},"最":{"docs":{},"终":{"docs":{},"，":{"docs":{},"获":{"docs":{},"取":{"docs":{},"多":{"docs":{},"数":{"docs":{},"票":{"docs":{},"且":{"docs":{},"最":{"docs":{},"先":{"docs":{},"结":{"docs":{},"束":{"docs":{},"选":{"docs":{},"举":{"docs":{},"倒":{"docs":{},"计":{"docs":{},"时":{"docs":{},"的":{"docs":{},"服":{"docs":{},"务":{"docs":{},"会":{"docs":{},"被":{"docs":{},"选":{"docs":{},"为":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"收":{"docs":{},"到":{"docs":{},"投":{"docs":{},"票":{"docs":{},"申":{"docs":{},"请":{"docs":{},"的":{"docs":{},"节":{"docs":{},"点":{"docs":{},"，":{"docs":{},"并":{"docs":{},"且":{"docs":{},"发":{"docs":{},"送":{"docs":{},"投":{"docs":{},"票":{"docs":{},"的":{"docs":{},"节":{"docs":{},"点":{"docs":{},"的":{"docs":{},"任":{"docs":{},"期":{"docs":{},"和":{"docs":{},"同":{"docs":{},"步":{"docs":{},"进":{"docs":{},"度":{"docs":{},"（":{"docs":{},"即":{"docs":{},"l":{"docs":{},"o":{"docs":{},"g":{"docs":{},"i":{"docs":{},"n":{"docs":{},"d":{"docs":{},"e":{"docs":{},"x":{"docs":{},"和":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"m":{"docs":{},"）":{"docs":{},"都":{"docs":{},"比":{"docs":{},"当":{"docs":{},"前":{"docs":{},"节":{"docs":{},"点":{"docs":{},"超":{"docs":{},"前":{"docs":{},"或":{"docs":{},"者":{"docs":{},"相":{"docs":{},"同":{"docs":{},"，":{"docs":{},"那":{"docs":{},"么":{"docs":{},"就":{"docs":{},"会":{"docs":{},"投":{"docs":{},"发":{"docs":{},"送":{"docs":{},"投":{"docs":{},"票":{"docs":{},"的":{"docs":{},"节":{"docs":{},"点":{"docs":{},"一":{"docs":{},"票":{"docs":{},"，":{"docs":{},"并":{"docs":{},"把":{"docs":{},"当":{"docs":{},"前":{"docs":{},"的":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"m":{"docs":{},"更":{"docs":{},"新":{"docs":{},"为":{"docs":{},"最":{"docs":{},"新":{"docs":{},"的":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"m":{"docs":{},"。":{"docs":{},"同":{"docs":{},"时":{"docs":{},"，":{"docs":{},"这":{"docs":{},"个":{"docs":{},"收":{"docs":{},"到":{"docs":{},"投":{"docs":{},"票":{"docs":{},"申":{"docs":{},"请":{"docs":{},"的":{"docs":{},"节":{"docs":{},"点":{"docs":{},"不":{"docs":{},"会":{"docs":{},"再":{"docs":{},"发":{"docs":{},"起":{"docs":{},"投":{"docs":{},"票":{"docs":{},"。":{"docs":{},"每":{"docs":{},"个":{"docs":{},"节":{"docs":{},"点":{"docs":{},"在":{"docs":{},"同":{"docs":{},"一":{"docs":{},"任":{"docs":{},"期":{"docs":{},"内":{"docs":{},"只":{"docs":{},"会":{"docs":{},"投":{"docs":{},"票":{"docs":{},"一":{"docs":{},"次":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"日":{"docs":{},"志":{"docs":{},"复":{"docs":{},"制":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}},"节":{"docs":{},"点":{"docs":{},"状":{"docs":{},"态":{"docs":{},"：":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}},"被":{"docs":{},"选":{"docs":{},"为":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"节":{"docs":{},"点":{"docs":{},"会":{"docs":{},"发":{"docs":{},"送":{"docs":{},"广":{"docs":{},"播":{"docs":{},"通":{"docs":{},"知":{"docs":{},"其":{"docs":{},"他":{"docs":{},"节":{"docs":{},"点":{"docs":{},"，":{"docs":{},"并":{"docs":{},"向":{"docs":{},"其":{"docs":{},"他":{"docs":{},"节":{"docs":{},"点":{"docs":{},"同":{"docs":{},"步":{"docs":{},"新":{"docs":{},"的":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"m":{"docs":{},"和":{"docs":{},"同":{"docs":{},"步":{"docs":{},"进":{"docs":{},"度":{"docs":{},"情":{"docs":{},"况":{"docs":{},"。":{"docs":{},"同":{"docs":{},"时":{"docs":{},"，":{"docs":{},"新":{"docs":{},"l":{"docs":{},"e":{"docs":{},"a":{"docs":{},"d":{"docs":{},"e":{"docs":{},"r":{"docs":{},"会":{"docs":{},"在":{"docs":{},"任":{"docs":{},"期":{"docs":{},"期":{"docs":{},"间":{"docs":{},"周":{"docs":{},"期":{"docs":{},"性":{"docs":{},"发":{"docs":{},"送":{"docs":{},"心":{"docs":{},"跳":{"docs":{},"，":{"docs":{},"不":{"docs":{},"断":{"docs":{},"刷":{"docs":{},"新":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"的":{"docs":{},"超":{"docs":{},"时":{"docs":{},"时":{"docs":{},"间":{"docs":{},"，":{"docs":{},"保":{"docs":{},"证":{"docs":{},"各":{"docs":{},"个":{"docs":{},"f":{"docs":{},"o":{"docs":{},"l":{"docs":{},"l":{"docs":{},"o":{"docs":{},"w":{"docs":{},"e":{"docs":{},"r":{"docs":{},"不":{"docs":{},"会":{"docs":{},"因":{"docs":{},"为":{"docs":{},"超":{"docs":{},"时":{"docs":{},"而":{"docs":{},"切":{"docs":{},"换":{"docs":{},"到":{"docs":{},"选":{"docs":{},"举":{"docs":{},"模":{"docs":{},"式":{"docs":{},"。":{"docs":{},"如":{"docs":{},"果":{"docs":{},"节":{"docs":{},"点":{"docs":{},"收":{"docs":{},"到":{"docs":{},"上":{"docs":{},"一":{"docs":{},"任":{"docs":{},"期":{"docs":{},"的":{"docs":{},"心":{"docs":{},"跳":{"docs":{},"，":{"docs":{},"会":{"docs":{},"拒":{"docs":{},"绝":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"选":{"docs":{},"举":{"docs":{},"结":{"docs":{},"束":{"docs":{},"后":{"docs":{},"，":{"docs":{},"所":{"docs":{},"有":{"docs":{},"节":{"docs":{},"点":{"docs":{},"进":{"docs":{},"入":{"docs":{},"数":{"docs":{},"据":{"docs":{},"同":{"docs":{},"步":{"docs":{},"状":{"docs":{},"态":{"docs":{},"。":{"docs":{"read_more_write_less/raft.html":{"ref":"read_more_write_less/raft.html","tf":0.041666666666666664}}}}}}}}}}}}}}}}}}}}}},"length":26},"corpusTokens":["candidate：选举模式，集群中没有leader节点。","follow","introduct","leader宕机后，follower如果在超时时间内没有收到leader的心跳，会发起新一轮的leader投票选举。如果全部follower都在同一时间发起leader投票选举，会造成选举混乱，raft利用随机超时巧妙避开了这些问题。","leader强制覆盖之后不一致的日志。","leader找到follower与自己相同的最大日志项，意味着follower之前的日志都与leader的日志相同。","leader是如何识别出follower的日志与自己的日志有差异呢？","leader给follower同步日志的时候，会同时带上leader上一条日志的任期和索引号，与follower当前的同步进度进行对比。","leader选举","leader：负责接收写请求，同步日志给follower，维护与follower的心跳，刷新follower的超时时间","raft","raft复制过程：leader接收到客户端发来的请求，创建一个新的日志项，并将其追加到本地日志中，接着leader通过追加条目rpc请求，将新的日志项复制到follower的本地日志中，当leader收到大多数follower的成功响应之后，则将这条日志项应用到状态机中，可以理解为该条日志写成功了，最后leader返回日志写成功的消息响应客户端。","raft的日志以日志项（logentry）的形式来组织，每个日志项包含一条命令、任期信息（term）、索引值（logindex）","共识算法","因此，raft日志追加大致分为两个步骤：","在raft的日志机制中，为了简化日志一致性的行为，有以下两点特性：","如何保证日志的一致性？","如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们之前的所有日志条目也全部相同。","如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们存储了相同的指令。","所有服务都没有获取到多数票，就会等当前选举超时后，对term加1，再次进行选举。最终，获取多数票且最先结束选举倒计时的服务会被选为leader。","收到投票申请的节点，并且发送投票的节点的任期和同步进度（即logindex和term）都比当前节点超前或者相同，那么就会投发送投票的节点一票，并把当前的term更新为最新的term。同时，这个收到投票申请的节点不会再发起投票。每个节点在同一任期内只会投票一次。","日志复制","节点状态：","被选为leader的节点会发送广播通知其他节点，并向其他节点同步新的term和同步进度情况。同时，新leader会在任期期间周期性发送心跳，不断刷新follower的超时时间，保证各个follower不会因为超时而切换到选举模式。如果节点收到上一任期的心跳，会拒绝。","读多写少系统","选举结束后，所有节点进入数据同步状态。"],"pipeline":["stopWordFilter","stemmer"]},"store":{"./":{"url":"./","title":"Introduction","keywords":"","body":"Introduction\n"},"read_more_write_less/":{"url":"read_more_write_less/","title":"读多写少系统","keywords":"","body":"读多写少系统\n"},"read_more_write_less/raft.html":{"url":"read_more_write_less/raft.html","title":"Raft","keywords":"","body":"共识算法 - Raft\nLeader选举\n节点状态：\n\nleader：负责接收写请求，同步日志给follower，维护与follower的心跳，刷新follower的超时时间\nfollower\ncandidate：选举模式，集群中没有leader节点。\nleader宕机后，follower如果在超时时间内没有收到leader的心跳，会发起新一轮的leader投票选举。如果全部follower都在同一时间发起leader投票选举，会造成选举混乱，raft利用随机超时巧妙避开了这些问题。\n\n\n收到投票申请的节点，并且发送投票的节点的任期和同步进度（即logIndex和term）都比当前节点超前或者相同，那么就会投发送投票的节点一票，并把当前的term更新为最新的term。同时，这个收到投票申请的节点不会再发起投票。每个节点在同一任期内只会投票一次。\n所有服务都没有获取到多数票，就会等当前选举超时后，对term加1，再次进行选举。最终，获取多数票且最先结束选举倒计时的服务会被选为leader。\n被选为leader的节点会发送广播通知其他节点，并向其他节点同步新的term和同步进度情况。同时，新leader会在任期期间周期性发送心跳，不断刷新follower的超时时间，保证各个follower不会因为超时而切换到选举模式。如果节点收到上一任期的心跳，会拒绝。\n选举结束后，所有节点进入数据同步状态。\n日志复制\nRaft的日志以日志项（logEntry）的形式来组织，每个日志项包含一条命令、任期信息（term）、索引值（logIndex）\nRaft复制过程：leader接收到客户端发来的请求，创建一个新的日志项，并将其追加到本地日志中，接着leader通过追加条目RPC请求，将新的日志项复制到follower的本地日志中，当leader收到大多数follower的成功响应之后，则将这条日志项应用到状态机中，可以理解为该条日志写成功了，最后leader返回日志写成功的消息响应客户端。\n如何保证日志的一致性？\n在raft的日志机制中，为了简化日志一致性的行为，有以下两点特性：\n\n如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们存储了相同的指令。\n如果在不同的日志中的两个条目拥有相同的索引和任期号，那么他们之前的所有日志条目也全部相同。\n\n因此，raft日志追加大致分为两个步骤：\n\nleader找到follower与自己相同的最大日志项，意味着follower之前的日志都与leader的日志相同。\nleader强制覆盖之后不一致的日志。\n\nleader是如何识别出follower的日志与自己的日志有差异呢？\nleader给follower同步日志的时候，会同时带上leader上一条日志的任期和索引号，与follower当前的同步进度进行对比。\n"}}}